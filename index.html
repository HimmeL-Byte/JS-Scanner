<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üîç JavaScript Info Disclosure Scanner</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #1e1e1e;
      color: #eee;
      padding: 30px;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: #2a2a2a;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 10px #000;
    }
    h1 {
      text-align: center;
      color: #46ff06;
    }
    input[type="file"] {
      background: #333;
      border: none;
      padding: 10px;
      border-radius: 5px;
      color: white;
    }
    #output {
      margin-top: 20px;
      background: #111;
      padding: 15px;
      border-radius: 5px;
      white-space: pre-wrap;
    }
    .match {
      background: #333;
      padding: 10px;
      margin: 8px 0;
      border-left: 4px solid #46ff06;
    }
    .match code {
      color: #8affff;
    }
    .loader {
      display: none;
      margin: 10px auto;
      border: 4px solid #555;
      border-top: 4px solid #46ff06;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîç JS Info Disclosure Scanner</h1>
    <input type="file" id="upload" accept=".js">
    <div class="loader" id="loader"></div>
    <div id="output"></div>
  </div>

  <script>
    const patterns = [
      { name: "API Key", regex: /(?<![\w])api[_-]?key['"]?\s*[:=]\s*['"]?[A-Za-z0-9_\-]{16,}['"]?/gi },
      { name: "Access Token", regex: /access[_-]?token['"]?\s*[:=]\s*['"]?[A-Za-z0-9\-_.=]{16,}['"]?/gi },
      { name: "JWT", regex: /eyJ[A-Za-z0-9\-_]+\.[A-Za-z0-9\-_]+\.[A-Za-z0-9\-_]+/g },
      { name: "AWS Access Key", regex: /AKIA[0-9A-Z]{16}/g },
      { name: "AWS Secret Key", regex: /(?:aws)?[_-]?secret['"]?\s*[:=]\s*['"]?[A-Za-z0-9\/+=]{40}['"]?/gi },
      { name: "Google API Key", regex: /AIza[0-9A-Za-z\-_]{35}/g },
      { name: "Firebase Config", regex: /firebaseConfig\s*=\s*{[\s\S]*?}/gi },
      { name: "Stripe Key", regex: /(sk|pk)_(live|test)_[0-9a-zA-Z]{20,}/g },
      { name: "SendGrid Key", regex: /SG\.[A-Za-z0-9._-]{10,}/g },
      { name: "Hardcoded Password", regex: /password['"]?\s*[:=]\s*['"][^'"]{4,}['"]/gi },
      { name: "DB URI", regex: /(mongodb|postgres|mysql):\/\/[^\s'"]+/gi },
      { name: "Base64 String", regex: /['"]?[A-Za-z0-9+/=]{40,}['"]?/g },
      { name: "Internal URL", regex: /url\s*[:=]\s*["']\/[a-z0-9\/\?\=\&\-_\.]+["']/gi },
      { name: "HTTP URL", regex: /https?:\/\/[^\s"'<>]+/gi },
      { name: "Suspicious Variable", regex: /\b(var|let|const)\s+[_$a-zA-Z0-9]{1,8}\s*=\s*['"][A-Za-z0-9+\/=]{30,}['"]/g },
      { name: "Suspicious Comment", regex: /\/\/\s*(key|secret|token|auth|pass|private)[^\n]*/gi }
    ];

    document.getElementById('upload').addEventListener('change', async function () {
      const file = this.files[0];
      const output = document.getElementById("output");
      const loader = document.getElementById("loader");
      output.innerHTML = '';
      loader.style.display = "block";

      const text = await file.text();
      const results = [];

      for (const { name, regex } of patterns) {
        let match;
        while ((match = regex.exec(text)) !== null) {
          results.push({ name, match: match[0] });
        }
      }

      loader.style.display = "none";

      if (results.length === 0) {
        output.innerHTML = "<i>‚úÖ Aman! Tidak ditemukan informasi sensitif.</i>";
      } else {
        results.forEach(result => {
          output.innerHTML += `<div class="match"><strong>${result.name}</strong>: <code>${result.match}</code></div>`;
        });
      }
    });
  </script>
</body>
</html>
